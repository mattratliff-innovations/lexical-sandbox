/**
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

'use strict';var p=require("lexical"),v=require("yjs"),x=require("@lexical/offset"),z=require("@lexical/selection"),A;function C(a){let b=new URLSearchParams;b.append("code",a);for(let c=1;c<arguments.length;c++)b.append("v",arguments[c]);throw Error(`Minified Lexical error #${a}; visit https://lexical.dev/docs/error?${b} for the full message or `+"use the non-minified dev environment for full errors and additional helpful warnings.");}
A=C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C["default"]:C;class E{constructor(a,b){this._key="";this._map=a;this._parent=b;this._type="linebreak"}getNode(){let a=p.$getNodeByKey(this._key);return p.$isLineBreakNode(a)?a:null}getKey(){return this._key}getSharedType(){return this._map}getType(){return this._type}getSize(){return 1}getOffset(){return this._parent.getChildOffset(this)}destroy(a){a.collabNodeMap.delete(this._key)}}
function F(a,b){b=new E(a,b);return a._collabNode=b}
class G{constructor(a,b,c,d){this._key="";this._map=a;this._parent=c;this._text=b;this._type=d;this._normalized=!1}getPrevNode(a){if(null===a)return null;a=a.get(this._key);return p.$isTextNode(a)?a:null}getNode(){let a=p.$getNodeByKey(this._key);return p.$isTextNode(a)?a:null}getSharedType(){return this._map}getType(){return this._type}getKey(){return this._key}getSize(){return this._text.length+(this._normalized?0:1)}getOffset(){return this._parent.getChildOffset(this)}spliceText(a,b,c){let d=this._parent._xmlText;
a=this.getOffset()+1+a;0!==b&&d.delete(a,b);""!==c&&d.insert(a,c)}syncPropertiesAndTextFromLexical(a,b,c){var d=this.getPrevNode(c);c=b.__text;H(a,this._map,d,b);if(null!==d&&(a=d.__text,a!==c)){d=b.__key;b=a;var e=p.$getSelection();a=c.length;p.$isRangeSelection(e)&&e.isCollapsed()&&(e=e.anchor,e.key===d&&(a=e.offset));d=b.length;let f=c.length,h=e=0;for(;e<d&&e<f&&b[e]===c[e]&&e<a;)e++;for(;h+e<d&&h+e<f&&b[d-h-1]===c[f-h-1];)h++;for(;h+e<d&&h+e<f&&b[e]===c[e];)e++;b=e;a=c.slice(e,f-h);d=d-e-h;this.spliceText(b,
d,a);this._text=c}}syncPropertiesAndTextFromYjs(a,b){let c=this.getNode();null===c&&A(84);I(a,this._map,c,b);a=this._text;c.__text!==a&&(c.getWritable().__text=a)}destroy(a){a.collabNodeMap.delete(this._key)}}function J(a,b,c,d){b=new G(a,b,c,d);return a._collabNode=b}let aa=new Set(["__key","__parent","__next","__prev"]),ba=new Set(["__first","__last","__size"]),ca=new Set(["__cachedText"]),da=new Set(["__text"]);
function K(a,b,c){if(aa.has(a))return!0;if(p.$isTextNode(b)){if(da.has(a))return!0}else if(p.$isElementNode(b)&&(ba.has(a)||p.$isRootNode(b)&&ca.has(a)))return!0;b=c.excludedProperties.get(b.constructor);return null!=b&&b.has(a)}function L(a){a=p.$getNodeByKey(a);null===a&&A(85);return a}
function M(a,b,c){let d=b.__type;if(p.$isElementNode(b)){var e=new v.XmlText;e=N(e,c,d);e.syncPropertiesFromLexical(a,b,null);e.syncChildrenFromLexical(a,b,null,null,null)}else p.$isTextNode(b)?(e=new v.Map,e=J(e,b.__text,c,d),e.syncPropertiesAndTextFromLexical(a,b,null)):p.$isLineBreakNode(b)?(a=new v.Map,a.set("__type","linebreak"),e=F(a,c)):p.$isDecoratorNode(b)?(e=new v.XmlElement,e=O(e,c,d),e.syncPropertiesFromLexical(a,b,null)):A(86);e._key=b.__key;return e}
function P(a,b,c){let d=b._collabNode;if(void 0===d){var e=a.editor._nodes;let f=b instanceof v.Map?b.get("__type"):b.getAttribute("__type");null==f&&A(87);void 0===e.get(f)&&A(88,f);e=b.parent;a=void 0===c&&null!==e?P(a,e):c||null;a instanceof Q||A(89);if(b instanceof v.XmlText)return N(b,a,f);if(b instanceof v.Map)return"linebreak"===f?F(b,a):J(b,"",a,f);if(b instanceof v.XmlElement)return O(b,a,f)}return d}
function I(a,b,c,d){d=null===d?b instanceof v.Map?Array.from(b.keys()):Object.keys(b.getAttributes()):Array.from(d);let e;for(let h=0;h<d.length;h++){let g=d[h];if(K(g,c,a))continue;var f=c[g];let k=b instanceof v.Map?b.get(g):b.getAttribute(g);if(f!==k){if(k instanceof v.Doc){let l=a.docMap;f instanceof v.Doc&&l.delete(f.guid);f=p.createEditor();let t=k.guid;f._key=t;l.set(t,k);k=f}void 0===e&&(e=c.getWritable());e[g]=k}}}
function H(a,b,c,d){var e=d.__type,f=a.nodeProperties;let h=f.get(e);void 0===h&&(h=Object.keys(d).filter(k=>!K(k,d,a)),f.set(e,h));e=a.editor.constructor;for(f=0;f<h.length;f++){let k=h[f];var g=null===c?void 0:c[k];let l=d[k];if(g!==l){if(l instanceof e){let t=a.docMap,n;g instanceof e&&(g=g._key,n=t.get(g),t.delete(g));g=n||new v.Doc;let m=g.guid;l._key=m;t.set(m,g);l=g;a.editor.update(()=>{d.markDirty()})}b instanceof v.Map?b.set(k,l):b.setAttribute(k,l)}}}
function R(a,b,c,d){return a.slice(0,b)+d+a.slice(b+c)}function S(a,b,c){let d=0,e=0,f=a._children,h=f.length;for(;e<h;e++){a=f[e];let g=d,k=a.getSize();d+=k;if((c?d>=b:d>b)&&a instanceof G)return c=b-g-1,0>c&&(c=0),{length:d-b,node:a,nodeIndex:e,offset:c};if(d>b)return{length:0,node:a,nodeIndex:e,offset:g};if(e===h-1)return{length:0,node:null,nodeIndex:e+1,offset:g+1}}return{length:0,node:null,nodeIndex:0,offset:0}}
function T(a){let b=a.anchor;a=a.focus;let c=!1;try{let d=b.getNode(),e=a.getNode();if(!d.isAttached()||!e.isAttached()||p.$isTextNode(d)&&b.offset>d.getTextContentSize()||p.$isTextNode(e)&&a.offset>e.getTextContentSize())c=!0}catch(d){c=!0}return c}function ea(a,b){a.doc.transact(b,a)}
function U(a){var b=a.getParent();if(null!==b){let e=a.getWritable();b=b.getWritable();var c=a.getPreviousSibling();a=a.getNextSibling();if(null===c)if(null!==a){var d=a.getWritable();b.__first=a.__key;d.__prev=null}else b.__first=null;else{d=c.getWritable();if(null!==a){let f=a.getWritable();f.__prev=d.__key;d.__next=f.__key}else d.__next=null;e.__prev=null}null===a?null!==c?(a=c.getWritable(),b.__last=c.__key,a.__next=null):b.__last=null:(a=a.getWritable(),null!==c?(c=c.getWritable(),c.__next=a.__key,
a.__prev=c.__key):a.__prev=null,e.__next=null);b.__size--;e.__parent=null}}function V(a,b){if(a=b._nodeMap.get(a)){var c=a.__prev,d=null;c&&(d=p.$getNodeByKey(c));null===d&&null!==a.__parent&&(d=p.$getNodeByKey(a.__parent));null===d?p.$getRoot().selectStart():null!==d&&d.isAttached()?d.selectEnd():V(d.__key,b)}else p.$getRoot().selectStart()}
class W{constructor(a,b,c){this._key="";this._xmlElem=a;this._parent=b;this._type=c}getPrevNode(a){if(null===a)return null;a=a.get(this._key);return p.$isDecoratorNode(a)?a:null}getNode(){let a=p.$getNodeByKey(this._key);return p.$isDecoratorNode(a)?a:null}getSharedType(){return this._xmlElem}getType(){return this._type}getKey(){return this._key}getSize(){return 1}getOffset(){return this._parent.getChildOffset(this)}syncPropertiesFromLexical(a,b,c){c=this.getPrevNode(c);H(a,this._xmlElem,c,b)}syncPropertiesFromYjs(a,
b){let c=this.getNode();null===c&&A(83);I(a,this._xmlElem,c,b)}destroy(a){a.collabNodeMap.delete(this._key)}}function O(a,b,c){b=new W(a,b,c);return a._collabNode=b}
class Q{constructor(a,b,c){this._key="";this._children=[];this._xmlText=a;this._type=c;this._parent=b}getPrevNode(a){if(null===a)return null;a=a.get(this._key);return p.$isElementNode(a)?a:null}getNode(){let a=p.$getNodeByKey(this._key);return p.$isElementNode(a)?a:null}getSharedType(){return this._xmlText}getType(){return this._type}getKey(){return this._key}isEmpty(){return 0===this._children.length}getSize(){return 1}getOffset(){let a=this._parent;null===a&&A(90);return a.getChildOffset(this)}syncPropertiesFromYjs(a,
b){let c=this.getNode();null===c&&A(91);I(a,this._xmlText,c,b)}applyChildrenYjsDelta(a,b){let c=this._children,d=0;for(let k=0;k<b.length;k++){var e=b[k],f=e.insert,h=e.delete;if(null!=e.retain)d+=e.retain;else if("number"===typeof h)for(e=h;0<e;){let {node:l,nodeIndex:t,offset:n,length:m}=S(this,d,!1);if(l instanceof Q||l instanceof E||l instanceof W)c.splice(t,1),--e;else if(l instanceof G){f=Math.min(e,m);h=0!==t?c[t-1]:null;var g=l.getSize();0===n&&m===g?(c.splice(t,1),g=R(l._text,n,f-1,""),0<
g.length&&(h instanceof G?h._text+=g:this._xmlText.delete(n,g.length))):l._text=R(l._text,n,f,"");e-=f}else break}else if(null!=f)if("string"===typeof f){let {node:l,offset:t}=S(this,d,!0);l instanceof G?l._text=R(l._text,t,0,f):this._xmlText.delete(t,f.length);d+=f.length}else({nodeIndex:e}=S(this,d,!1)),f=P(a,f,this),c.splice(e,0,f),d+=1;else throw Error("Unexpected delta format");}}syncChildrenFromYjs(a){var b=this.getNode();null===b&&A(92);var c=b.__key;let d=x.$createChildrenArray(b,null),e=
d.length;var f=this._children;let h=f.length,g=a.collabNodeMap,k=new Set,l;let t=0;var n=null;h!==e&&b.getWritable();for(let y=0;y<h;y++){var m=d[t],r=f[y];var u=r.getNode();var q=r._key;if(null!==u&&m===q)n=p.$isTextNode(u),k.add(m),n&&(r._key=m,r instanceof Q?(n=r._xmlText,r.syncPropertiesFromYjs(a,null),r.applyChildrenYjsDelta(a,n.toDelta()),r.syncChildrenFromYjs(a)):r instanceof G?r.syncPropertiesAndTextFromYjs(a,null):r instanceof W?r.syncPropertiesFromYjs(a,null):r instanceof E||A(93)),n=u,
t++;else{if(void 0===l)for(l=new Set,q=0;q<h;q++){var w=f[q]._key;""!==w&&l.add(w)}if(null!==u&&void 0!==m&&!l.has(m)){r=L(m);U(r);y--;t++;continue}u=b.getWritable();m=a;q=r;w=c;var B=q.getType();let D=m.editor._nodes.get(B);void 0===D&&A(88,B);B=new D.klass;B.__parent=w;q._key=B.__key;q instanceof Q?(w=q._xmlText,q.syncPropertiesFromYjs(m,null),q.applyChildrenYjsDelta(m,w.toDelta()),q.syncChildrenFromYjs(m)):q instanceof G?q.syncPropertiesAndTextFromYjs(m,null):q instanceof W&&q.syncPropertiesFromYjs(m,
null);m.collabNodeMap.set(B.__key,q);m=B;q=m.__key;g.set(q,r);null===n?(n=u.getFirstChild(),u.__first=q,null!==n&&(n=n.getWritable(),n.__prev=q,m.__next=n.__key)):(r=n.getWritable(),w=n.getNextSibling(),r.__next=q,m.__prev=n.__key,null!==w&&(n=w.getWritable(),n.__prev=q,m.__next=n.__key));y===h-1&&(u.__last=q);u.__size++;n=m}}for(b=0;b<e;b++)f=d[b],k.has(f)||(c=L(f),f=a.collabNodeMap.get(f),void 0!==f&&f.destroy(a),U(c))}syncPropertiesFromLexical(a,b,c){H(a,this._xmlText,this.getPrevNode(c),b)}_syncChildFromLexical(a,
b,c,d,e,f){b=this._children[b];c=L(c);b instanceof Q&&p.$isElementNode(c)?(b.syncPropertiesFromLexical(a,c,d),b.syncChildrenFromLexical(a,c,d,e,f)):b instanceof G&&p.$isTextNode(c)?b.syncPropertiesAndTextFromLexical(a,c,d):b instanceof W&&p.$isDecoratorNode(c)&&b.syncPropertiesFromLexical(a,c,d)}syncChildrenFromLexical(a,b,c,d,e){var f=this.getPrevNode(c);let h=null===f?[]:x.$createChildrenArray(f,c);f=x.$createChildrenArray(b,null);let g=h.length-1,k=f.length-1,l=a.collabNodeMap,t,n,m=0;for(b=0;m<=
g&&b<=k;){var r=h[m];let q=f[b];if(r===q)this._syncChildFromLexical(a,b,q,c,d,e),m++,b++;else{void 0===t&&(t=new Set(h));void 0===n&&(n=new Set(f));var u=n.has(r);r=t.has(q);u?(u=L(q),u=M(a,u,this),l.set(q,u),r?(this.splice(a,b,1,u),m++):this.splice(a,b,0,u),b++):(this.splice(a,b,1),m++)}}c=m>g;d=b>k;if(c&&!d)for(;b<=k;++b)c=f[b],d=L(c),d=M(a,d,this),this.append(d),l.set(c,d);else if(d&&!c)for(f=this._children.length-1;f>=b;f--)this.splice(a,f,1)}append(a){let b=this._xmlText;var c=this._children;
c=c[c.length-1];c=void 0!==c?c.getOffset()+c.getSize():0;if(a instanceof Q)b.insertEmbed(c,a._xmlText);else if(a instanceof G){let d=a._map;null===d.parent&&b.insertEmbed(c,d);b.insert(c+1,a._text)}else a instanceof E?b.insertEmbed(c,a._map):a instanceof W&&b.insertEmbed(c,a._xmlElem);this._children.push(a)}splice(a,b,c,d){let e=this._children;var f=e[b];if(void 0===f)void 0===d&&A(94),this.append(d);else{var h=f.getOffset();-1===h&&A(95);var g=this._xmlText;0!==c&&g.delete(h,f.getSize());d instanceof
Q?g.insertEmbed(h,d._xmlText):d instanceof G?(f=d._map,null===f.parent&&g.insertEmbed(h,f),g.insert(h+1,d._text)):d instanceof E?g.insertEmbed(h,d._map):d instanceof W&&g.insertEmbed(h,d._xmlElem);if(0!==c)for(h=e.slice(b,b+c),g=0;g<h.length;g++)h[g].destroy(a);void 0!==d?e.splice(b,c,d):e.splice(b,c)}}getChildOffset(a){let b=0,c=this._children;for(let d=0;d<c.length;d++){let e=c[d];if(e===a)return b;b+=e.getSize()}return-1}destroy(a){let b=a.collabNodeMap,c=this._children;for(let d=0;d<c.length;d++)c[d].destroy(a);
b.delete(this._key)}}function N(a,b,c){b=new Q(a,b,c);return a._collabNode=b}
function X(a,b){var c=b.collabNodeMap.get(a.key);if(void 0===c)return null;b=a.offset;let d=c.getSharedType();if(c instanceof G){d=c._parent._xmlText;a=c.getOffset();if(-1===a)return null;b=a+1+b}else if(c instanceof Q&&"element"===a.type){var e=a.getNode();p.$isElementNode(e)||A(184);c=a=0;for(e=e.getFirstChild();null!==e&&c++<b;)p.$isTextNode(e)?a+=e.getTextContentSize()+1:a++,e=e.getNextSibling();b=a}return v.createRelativePositionFromTypeIndex(d,b)}
function Y(a,b){if(null==a){if(null!=b)return!0}else if(null==b||!v.compareRelativePositions(a,b))return!0;return!1}function la(a,b){a=a.cursorsContainer;if(null!==a){b=b.selections;let c=b.length;for(let d=0;d<c;d++)a.removeChild(b[d])}}
function Z(a,b){let {anchorPos:c,focusPos:d}=b;b=null;let e=0,f=null,h=0;if(null!==c&&null!==d){let g=v.createAbsolutePositionFromRelativePosition(c,a.doc);a=v.createAbsolutePositionFromRelativePosition(d,a.doc);null!==g&&null!==a&&([b,e]=ma(g.type,g.index),[f,h]=ma(a.type,a.index))}return{anchorCollabNode:b,anchorOffset:e,focusCollabNode:f,focusOffset:h}}
function na(a,b){b=b.awareness.getLocalState();if(null!==b){var {anchorCollabNode:c,anchorOffset:d,focusCollabNode:e,focusOffset:f}=Z(a,b);if(null!==c&&null!==e){a=c.getKey();b=e.getKey();let h=p.$getSelection();p.$isRangeSelection(h)&&(oa(h.anchor,a,d),oa(h.focus,b,f))}}}
function oa(a,b,c){if(a.key!==b||a.offset!==c){let d=p.$getNodeByKey(b);if(null!==d&&!p.$isElementNode(d)&&!p.$isTextNode(d)){let e=d.getParentOrThrow();b=e.getKey();c=d.getIndexWithinParent();d=e}a.set(b,c,p.$isElementNode(d)?"element":"text")}}function ma(a,b){a=a._collabNode;if(void 0===a)return[null,0];if(a instanceof Q){let {node:c,offset:d}=S(a,b,!0);return null===c?[a,0]:[c,d]}return[null,0]}
function pa(a,b){var c=Array.from(b.awareness.getStates()),d=a.clientID;b=a.cursors;var e=a.editor._editorState._nodeMap;let f=new Set;for(var h=0;h<c.length;h++){let [D,fa]=c[h];if(D!==d){f.add(D);let {name:ra,color:sa,focusing:ta}=fa;var g=null,k=b.get(D);void 0===k&&(k={color:sa,name:ra,selection:null},b.set(D,k));if(ta){let {anchorCollabNode:ha,anchorOffset:ia,focusCollabNode:ja,focusOffset:ka}=Z(a,fa);if(null!==ha&&null!==ja){var l=ha.getKey(),t=ja.getKey();g=k.selection;if(null===g){g=k;var n=
ia,m=ka,r=g.color,u=document.createElement("span");u.style.cssText=`position:absolute;top:0;bottom:0;right:-1px;width:1px;background-color:${r};z-index:10;`;var q=document.createElement("span");q.textContent=g.name;q.style.cssText=`position:absolute;left:-2px;top:-16px;background-color:${r};color:#fff;line-height:12px;font-size:12px;padding:2px;font-family:Arial;font-weight:bold;white-space:nowrap;`;u.appendChild(q);g={anchor:{key:l,offset:n},caret:u,color:r,focus:{key:t,offset:m},name:q,selections:[]}}else n=
g.anchor,m=g.focus,n.key=l,n.offset=ia,m.key=t,m.offset=ka}}a:if(l=a,n=k,u=g,r=e,m=l.editor,g=m.getRootElement(),k=l.cursorsContainer,null!==k&&null!==g&&(g=k.offsetParent,null!==g))if(g=g.getBoundingClientRect(),t=n.selection,null===u)null!==t&&(n.selection=null,la(l,t));else{n.selection=u;n=u.caret;t=u.color;l=u.selections;q=u.anchor;u=u.focus;var w=q.key,B=u.key,y=r.get(w);r=r.get(B);if(null!=y&&null!=r){if(y===r&&p.$isLineBreakNode(y))r=[m.getElementByKey(w).getBoundingClientRect()];else{r=z.createDOMRange(m,
y,q.offset,r,u.offset);if(null===r)break a;r=z.createRectsFromDOMRange(m,r)}u=l.length;m=r.length;for(q=0;q<m;q++)y=r[q],w=l[q],void 0===w&&(w=document.createElement("span"),l[q]=w,B=document.createElement("span"),w.appendChild(B),k.appendChild(w)),y=`position:absolute;top:${y.top-g.top}px;left:${y.left-g.left}px;height:${y.height}px;width:${y.width}px;pointer-events:none;z-index:5;`,w.style.cssText=y,w.firstChild.style.cssText=`${y}left:0;top:0;background-color:${t};opacity:0.3;`,q===m-1&&n.parentNode!==
w&&w.appendChild(n);for(g=u-1;g>=m;g--)k.removeChild(l[g]),l.pop()}}}}c=Array.from(b.keys());for(d=0;d<c.length;d++)e=c[d],f.has(e)||(h=b.get(e),void 0!==h&&(h=h.selection,null!==h&&la(a,h),b.delete(e)))}
function qa(a,b,c,d){b=b.awareness;let e=b.getLocalState();if(null!==e){var {anchorPos:f,focusPos:h,name:g,color:k,focusing:l,awarenessData:t}=e,n=null,m=null;if(null!==d&&(null===f||d.is(c))||null!==c)p.$isRangeSelection(d)&&(n=X(d.anchor,a),m=X(d.focus,a)),(Y(f,n)||Y(h,m))&&b.setLocalState({...e,anchorPos:n,awarenessData:t,color:k,focusPos:m,focusing:l,name:g})}}let ua=p.createCommand("CONNECTED_COMMAND"),va=p.createCommand("TOGGLE_CONNECT_COMMAND");exports.CONNECTED_COMMAND=ua;
exports.TOGGLE_CONNECT_COMMAND=va;exports.createBinding=function(a,b,c,d,e,f){void 0!==d&&null!==d||A(81);b=d.get("root",v.XmlText);b=N(b,null,"root");b._key="root";return{clientID:d.clientID,collabNodeMap:new Map,cursors:new Map,cursorsContainer:null,doc:d,docMap:e,editor:a,excludedProperties:f||new Map,id:c,nodeProperties:new Map,root:b}};exports.createUndoManager=function(a,b){return new v.UndoManager(b,{trackedOrigins:new Set([a,null])})};exports.getAnchorAndFocusCollabNodesForUserState=Z;
exports.initLocalState=function(a,b,c,d,e){a.awareness.setLocalState({anchorPos:null,awarenessData:e,color:c,focusPos:null,focusing:d,name:b})};exports.setLocalStateFocus=function(a,b,c,d,e){({awareness:a}=a);let f=a.getLocalState();null===f&&(f={anchorPos:null,awarenessData:e,color:c,focusPos:null,focusing:d,name:b});f.focusing=d;a.setLocalState(f)};exports.syncCursorPositions=pa;
exports.syncLexicalUpdateToYjs=function(a,b,c,d,e,f,h,g){ea(a,()=>{d.read(()=>{if(g.has("collaboration")||g.has("historic")){if(0<h.size){var k=Array.from(h),l=a.collabNodeMap,t=[];for(let u=0;u<k.length;u++){var n=k[u],m=p.$getNodeByKey(n),r=l.get(n);if(r instanceof G)if(p.$isTextNode(m))t.push([r,m.__text]);else{m=r.getOffset();if(-1===m)continue;let q=r._parent;r._normalized=!0;q._xmlText.delete(m,1);l.delete(n);n=q._children;r=n.indexOf(r);n.splice(r,1)}}for(k=0;k<t.length;k++){let [u,q]=t[k];
u instanceof G&&"string"===typeof q&&(u._text=q)}}}else e.has("root")&&(t=c._nodeMap,k=p.$getRoot(),l=a.root,l.syncPropertiesFromLexical(a,k,t),l.syncChildrenFromLexical(a,k,t,e,f)),t=p.$getSelection(),qa(a,b,c._selection,t)})})};
exports.syncYjsChangesToLexical=function(a,b,c,d){let e=a.editor,f=e._editorState;c.forEach(h=>h.delta);e.update(()=>{for(var h=0;h<c.length;h++){var g=a,k=c[h],{target:l}=k;l=P(g,l);if(l instanceof Q&&k instanceof v.YTextEvent){let {keysChanged:t,childListChanged:n,delta:m}=k;0<t.size&&l.syncPropertiesFromYjs(g,t);n&&(l.applyChildrenYjsDelta(g,m),l.syncChildrenFromYjs(g))}else l instanceof G&&k instanceof v.YMapEvent?({keysChanged:k}=k,0<k.size&&l.syncPropertiesAndTextFromYjs(g,k)):l instanceof W&&
k instanceof v.YXmlEvent?({attributesChanged:k}=k,0<k.size&&l.syncPropertiesFromYjs(g,k)):A(82)}g=p.$getSelection();p.$isRangeSelection(g)&&(T(g)?(h=f._selection,p.$isRangeSelection(h)&&(na(a,b),T(g)&&V(g.anchor.key,f)),qa(a,b,h,p.$getSelection())):na(a,b))},{onUpdate:()=>{pa(a,b);e.update(()=>{0===p.$getRoot().getChildrenSize()&&p.$getRoot().append(p.$createParagraphNode())})},skipTransforms:!0,tag:d?"historic":"collaboration"})}
